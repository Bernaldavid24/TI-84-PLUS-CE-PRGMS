ClrHome
Disp "RSA DECRYPTION"
Disp " "

If A=0 or C=0
Then
Disp "NO KEYS FOUND!"
Disp "RUN KEYGEN FIRST"
Stop
End

A→N
C→D

Disp "PRIVATE KEY:"
Disp "N =",N
Disp "D =",D
Disp " "

Input "CIPHERTEXT: ",CIPHER
Disp " "

If CIPHER≥N or CIPHER<1
Then
Disp "ERROR: INVALID"
Disp "CIPHERTEXT"
Stop
End

CIPHER→R
1→T
D→F

Lbl DECRYPT
If fPart(F/2)≠0
Then
R*T→T
T-N*iPart(T/N)→T
End
R*R→R
R-N*iPart(R/N)→R
iPart(F/2)→F
If F>0
Goto DECRYPT

T→MESSAGE

ClrHome
Disp "DECRYPTION COMPLETE"
Disp " "
Disp "ENCRYPTED MESSAGE:"
Disp CIPHER
Disp " "
Disp "DECRYPTED MESSAGE:"
Disp MESSAGE
Disp " "
Disp "VERIFICATION:"
Disp "C^D mod N =",MESSAGE

Pause
